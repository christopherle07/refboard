<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="view-transition" content="same-origin">
    <title>EyeDea</title>
    <script>
        // Apply theme IMMEDIATELY before any CSS loads
        (function() {
            const savedSettings = JSON.parse(localStorage.getItem('canvas_settings') || '{}');
            const theme = savedSettings.theme || 'light';
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>
    <!-- Local bundled fonts -->
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/browser-homepage.css">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/sidebar.css">
    <link rel="stylesheet" href="css/modal.css">
    <link rel="stylesheet" href="css/settingsModal.css">
    <link rel="stylesheet" href="css/library.css">
    <link rel="stylesheet" href="css/titlebar.css">
    <link rel="stylesheet" href="css/tabs.css">
    <link rel="stylesheet" href="css/views.css">
    <link rel="stylesheet" href="css/assets-library.css">
    <link rel="stylesheet" href="css/transitions.css">
    <link rel="stylesheet" href="css/media-controls.css">
</head>
<body>
    <!-- Unified Titlebar/Nav Bar -->
    <div class="unified-titlebar" data-tauri-drag-region>
        <div class="titlebar-window-controls">
            <button class="titlebar-button close-btn" id="titlebar-close" title="Close">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                    <line x1="1" y1="1" x2="11" y2="11" stroke="currentColor" stroke-width="1"/>
                    <line x1="11" y1="1" x2="1" y2="11" stroke="currentColor" stroke-width="1"/>
                </svg>
            </button>
            <button class="titlebar-button minimize-btn" id="titlebar-minimize" title="Minimize">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                    <line x1="0" y1="6" x2="12" y2="6" stroke="currentColor" stroke-width="1"/>
                </svg>
            </button>
            <button class="titlebar-button maximize-btn" id="titlebar-maximize" title="Maximize">
                <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
                    <rect x="1" y="1" width="10" height="10" stroke="currentColor" stroke-width="1" fill="none"/>
                </svg>
            </button>
        </div>
        <button class="titlebar-sidebar-toggle" id="sidebar-toggle-btn">
            <img src="/assets/sidebar-col.svg" alt="Toggle Sidebar" class="sidebar-toggle-icon">
        </button>
        <div class="titlebar-undo-redo">
            <button class="undo-redo-btn" id="undo-btn" title="Undo (Ctrl+Z)" disabled>
                <img src="/assets/undo-svgrepo-com.svg" alt="Undo" class="undo-redo-icon">
            </button>
            <button class="undo-redo-btn" id="redo-btn" title="Redo (Ctrl+Y)" disabled>
                <img src="/assets/undo-svgrepo-com.svg" alt="Redo" class="undo-redo-icon redo-flipped">
            </button>
        </div>
        <div class="titlebar-nav-container" data-tauri-drag-region>
            <button class="nav-back-btn" id="nav-back-btn" title="Go Back" style="display: none;">
                <img src="/assets/back.png" alt="Back" class="nav-back-icon">
            </button>
            <div class="nav-breadcrumb" id="nav-breadcrumb">
                <span class="breadcrumb-item active">All Boards</span>
            </div>
            <button class="new-board-btn" id="open-floating-btn" title="Open Canvas Window" style="display: none;">
                <img src="/assets/new-window-icon.svg" alt="Open Window" style="width: 16px; height: 16px;">
            </button>
            <button class="floating-help-btn" id="floating-help-btn" title="What's this?" style="display: none;">?</button>
        </div>
        <div class="titlebar-actions">
            <button class="toolbar-icon-btn" id="library-btn" title="Library">
                <img src="/assets/library.svg" alt="Library" class="toolbar-icon">
            </button>
            <button class="toolbar-icon-btn" id="import-board-btn" title="Import Board">
                <img src="/assets/import.svg" alt="Import" class="toolbar-icon">
            </button>
            <button class="toolbar-icon-btn" id="settings-btn" title="Settings">
                <img src="/assets/settings.svg" alt="Settings" class="toolbar-icon">
            </button>
        </div>
    </div>

    <!-- Home View -->
    <div class="view-container home-view">
        <div class="browser-homepage">

            <div class="browser-content">
                <div class="homepage-layout">
                    <!-- Left: Main boards area -->
                    <div class="homepage-main">
                        <!-- Top bar: search + actions -->
                        <div class="homepage-topbar">
                            <div class="search-container">
                                <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="11" cy="11" r="8"></circle>
                                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                                </svg>
                                <input type="text" class="board-search" id="board-search" placeholder="Search boards..." autocomplete="off">
                            </div>
                            <div class="topbar-actions">
                                <button class="topbar-action-btn" id="new-board-btn-search" title="New Board">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <line x1="12" y1="5" x2="12" y2="19"></line>
                                        <line x1="5" y1="12" x2="19" y2="12"></line>
                                    </svg>
                                </button>
                                <button class="topbar-action-btn" id="import-board-btn-search" title="Import Board">
                                    <img src="/assets/import.svg" alt="Import">
                                </button>
                            </div>
                        </div>

                        <!-- Controls bar: sort + view toggle -->
                        <div class="homepage-controls">
                            <div class="sort-controls">
                                <select id="sort-select" class="sort-select">
                                    <option value="recent">Last modified</option>
                                    <option value="oldest">Oldest first</option>
                                    <option value="alphabetical">Alphabetical</option>
                                </select>
                            </div>
                            <button class="view-toggle-btn" id="view-toggle-btn" title="Toggle view">
                                <svg class="view-icon-grid" width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                    <rect x="3" y="3" width="7" height="7" rx="1"/>
                                    <rect x="14" y="3" width="7" height="7" rx="1"/>
                                    <rect x="3" y="14" width="7" height="7" rx="1"/>
                                    <rect x="14" y="14" width="7" height="7" rx="1"/>
                                </svg>
                                <svg class="view-icon-list" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="display:none">
                                    <rect x="3" y="4" width="18" height="3" rx="1"/>
                                    <rect x="3" y="10" width="18" height="3" rx="1"/>
                                    <rect x="3" y="16" width="18" height="3" rx="1"/>
                                </svg>
                            </button>
                        </div>

                        <!-- Board grid -->
                        <div class="boards-grid" id="boards-grid"></div>

                        <!-- Pagination -->
                        <div class="pagination-controls" id="pagination-controls">
                            <button class="pagination-btn" id="prev-page-btn" disabled>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="15 18 9 12 15 6"></polyline>
                                </svg>
                            </button>
                            <span class="pagination-info" id="pagination-info">1 / 1</span>
                            <button class="pagination-btn" id="next-page-btn" disabled>
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="9 18 15 12 9 6"></polyline>
                                </svg>
                            </button>
                        </div>
                    </div>

                    <!-- Right: Pinned boards sidebar -->
                    <div class="pinned-sidebar" id="pinned-sidebar">
                        <div class="pinned-header">Pinned</div>
                        <div class="pinned-boards" id="pinned-boards">
                            <!-- Pinned board cards rendered by JS -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Board Editor View -->
    <div class="view-container board-view">
        <div class="editor-container">
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-header">
                    <div class="board-name-wrapper">
                        <h2 class="board-name" id="board-name">Untitled Board</h2>
                        <button class="board-dropdown-btn" id="board-dropdown-btn"></button>
                        <div class="board-dropdown-menu" id="board-dropdown-menu">
                            <div class="dropdown-item" id="dropdown-rename">Rename Board</div>
                            <div class="dropdown-separator"></div>
                            <div class="dropdown-item" id="dropdown-export">Export Board</div>
                            <div class="dropdown-item" id="dropdown-import">Import to Board</div>
                            <div class="dropdown-item" id="dropdown-export-lines">Export Lines</div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-tabs">
                    <button class="tab-btn active" data-tab="layers">Layers</button>
                    <button class="tab-btn" data-tab="assets">Assets</button>
                </div>

                <div class="sidebar-content">
                    <div class="panel-section layers-section-scrollable">
                        <div class="panel-section-header">
                            <h3>Layers</h3>
                            <div class="header-actions">
                                <button class="collapse-btn" id="collapse-layers-btn">
                                    <img src="/assets/collapse.svg" alt="Collapse" class="collapse-icon" width="14" height="14"/>
                                </button>
                            </div>
                        </div>
                        <div class="panel-section-content" id="layers-content">
                            <div class="layers-list" id="layers-list">
                                <div class="empty-message">No layers yet</div>
                            </div>
                        </div>
                    </div>

                    <div class="properties-section" id="default-properties">
                        <div class="property-row">
                            <label>Background</label>
                            <input type="color" id="bg-color" value="#ffffff">
                        </div>
                    </div>

                    <div class="object-properties-section" id="object-properties" style="display: none;">
                        <div class="properties-header">
                            <h3 id="object-properties-title">Properties</h3>
                            <button class="close-properties-btn" id="close-properties-btn">×</button>
                        </div>
                        <div class="properties-content" id="properties-content">
                            <!-- Shape properties -->
                            <div class="shape-properties" id="shape-properties" style="display: none;">
                                <div class="property-row">
                                    <label>Shape Type</label>
                                    <select id="shape-type" class="property-select">
                                        <option value="square">Square</option>
                                        <option value="circle">Circle</option>
                                        <option value="line">Line</option>
                                        <option value="arrow">Arrow</option>
                                    </select>
                                </div>
                                <div class="property-row">
                                    <label>Fill Color</label>
                                    <input type="color" id="shape-fill-color" value="#3b82f6">
                                </div>
                                <div class="property-row">
                                    <label>Stroke</label>
                                    <label class="toggle-switch" style="margin-left: auto;">
                                        <input type="checkbox" id="shape-has-stroke" checked>
                                        <span class="toggle-slider"></span>
                                    </label>
                                </div>
                                <div class="property-row" id="shape-stroke-color-row">
                                    <label>Stroke Color</label>
                                    <input type="color" id="shape-stroke-color" value="#000000">
                                </div>
                                <div class="property-row" id="shape-stroke-width-row">
                                    <label>Stroke Width</label>
                                    <input type="number" id="shape-stroke-width" min="0" max="20" value="2" class="property-input">
                                </div>
                                <div class="property-row" id="shape-corner-radius-row" style="display: none;">
                                    <label>Corner Radius</label>
                                    <input type="number" id="shape-corner-radius" min="0" max="100" value="0" class="property-input">
                                </div>
                                <div class="property-row" id="shape-line-color-row" style="display: none;">
                                    <label>Line Color</label>
                                    <input type="color" id="shape-line-color" value="#000000">
                                </div>
                                <div class="property-row" id="shape-line-thickness-row" style="display: none;">
                                    <label>Line Thickness</label>
                                    <input type="number" id="shape-line-thickness" min="1" max="50" value="5" class="property-input">
                                </div>
                            </div>

                            <!-- Text properties -->
                            <div class="text-properties" id="text-properties" style="display: none;">
                                <div class="property-row">
                                    <label>Text</label>
                                    <textarea id="text-content" class="text-content-input" rows="3" placeholder="Enter text..."></textarea>
                                </div>
                                <div class="property-row">
                                    <label>Font Size</label>
                                    <input type="number" id="text-font-size" min="8" max="200" value="32" class="property-input">
                                </div>
                                <div class="property-row">
                                    <label>Font Family</label>
                                    <div id="font-dropdown-container" class="font-dropdown-container"></div>
                                </div>
                                <div class="property-row">
                                    <label>Text Color</label>
                                    <input type="color" id="text-color" value="#000000">
                                </div>
                                <div class="property-row">
                                    <label>Font Weight</label>
                                    <select id="text-font-weight" class="property-select">
                                        <option value="normal">Normal</option>
                                        <option value="bold">Bold</option>
                                    </select>
                                </div>
                                <div class="property-row">
                                    <label>Text Align</label>
                                    <select id="text-align" class="property-select">
                                        <option value="left">Left</option>
                                        <option value="center">Center</option>
                                        <option value="right">Right</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="palette-sidebar-section" id="palette-sidebar-section" style="display: none;">
                        <div class="panel-section-header">
                            <span class="panel-section-title">PALETTE COLORS</span>
                        </div>
                        <div class="palette-swatches" id="palette-swatches"></div>
                    </div>
                </div>
            </aside>

            <main class="canvas-area">
                <!-- Procreate-style Drawing Controls -->
                <div class="draw-size-slider-container" id="draw-size-slider-container">
                    <input type="range" id="draw-size-slider" class="draw-size-slider-vertical" min="1" max="800" value="8">
                    <div class="draw-size-input-wrapper">
                        <input type="number" id="draw-size-input" class="draw-size-input" min="1" value="8" title="Brush size (no max limit)">
                    </div>
                </div>

                <div class="draw-controls-container" id="drawing-toolbar">
                    <div class="draw-tool-selector" id="draw-tool-selector">
                        <button class="draw-tool-current" id="draw-tool-current">
                            <svg class="draw-tool-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 19l7-7 3 3-7 7-3-3z"/>
                                <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
                                <path d="M2 2l7.586 7.586"/>
                            </svg>
                        </button>
                        <div class="draw-tool-dropdown" id="draw-tool-dropdown">
                            <button class="draw-tool-option active" id="draw-pen-btn" data-tool="pen">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 19l7-7 3 3-7 7-3-3z"/>
                                    <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"/>
                                    <path d="M2 2l7.586 7.586"/>
                                </svg>
                                <span>Pen</span>
                            </button>
                            <button class="draw-tool-option" id="draw-highlighter-btn" data-tool="highlighter">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M9 11l-6 6v3h9l3-3"/>
                                    <path d="M22 12l-4.6 4.6a2 2 0 01-2.8 0l-5.2-5.2a2 2 0 010-2.8L14 4"/>
                                </svg>
                                <span>Highlighter</span>
                            </button>
                            <button class="draw-tool-option" id="draw-eraser-btn" data-tool="eraser">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 20H7L3 16a1 1 0 010-1.4l9.9-9.9a1 1 0 011.4 0l5.3 5.3a1 1 0 010 1.4L11 20"/>
                                    <path d="M6 11l8 8"/>
                                </svg>
                                <span>Eraser</span>
                            </button>
                        </div>
                    </div>

                    <!-- Eraser mode toggle - shows when eraser is active -->
                    <div class="eraser-mode-toggle" id="eraser-mode-toggle" style="display: none;">
                        <button class="eraser-mode-btn active" data-mode="strokes" title="Erase drawn strokes">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round">
                                <path d="M3 17c3-3 5 2 9 0s6 3 9 0"/>
                                <path d="M3 12c3-3 5 2 9 0s6 3 9 0"/>
                                <path d="M3 7c3-3 5 2 9 0s6 3 9 0"/>
                            </svg>
                        </button>
                        <button class="eraser-mode-btn" data-mode="pixels" title="Erase image pixels">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="3" width="18" height="18" rx="2"/>
                                <path d="M9 3v18M15 3v18M3 9h18M3 15h18"/>
                            </svg>
                        </button>
                    </div>

                    <button class="draw-clear-btn" id="draw-clear-btn" title="Clear All">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M3 6h18"/>
                            <path d="M8 6V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                            <path d="M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6"/>
                        </svg>
                    </button>

                    <div class="draw-color-picker-wrapper">
                        <input type="color" id="draw-color-picker" class="draw-color-picker" value="#000000" title="Drawing Color">
                    </div>
                </div>
                <input type="number" id="draw-size-input" style="display: none;" min="1" max="500" value="8">

                <!-- Floating Text Toolbar -->
                <div class="floating-toolbar" id="floating-text-toolbar" style="display: none;">
                    <div class="floating-toolbar-content">
                        <div id="floating-font-dropdown-container"></div>
                        <input type="number" id="floating-font-size" min="8" max="200" value="32" class="floating-input" title="Font Size">
                        <button class="floating-btn" id="floating-text-bold" title="Bold"><strong>B</strong></button>
                        <input type="color" id="floating-text-color" value="#000000" class="floating-color" title="Text Color">
                        <div class="floating-separator"></div>
                        <button class="floating-btn" id="floating-text-align-left" title="Align Left">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <rect x="2" y="3" width="12" height="2"/>
                                <rect x="2" y="7" width="8" height="2"/>
                                <rect x="2" y="11" width="10" height="2"/>
                            </svg>
                        </button>
                        <button class="floating-btn" id="floating-text-align-center" title="Align Center">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <rect x="2" y="3" width="12" height="2"/>
                                <rect x="4" y="7" width="8" height="2"/>
                                <rect x="3" y="11" width="10" height="2"/>
                            </svg>
                        </button>
                        <button class="floating-btn" id="floating-text-align-right" title="Align Right">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <rect x="2" y="3" width="12" height="2"/>
                                <rect x="6" y="7" width="8" height="2"/>
                                <rect x="4" y="11" width="10" height="2"/>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Floating Shape Toolbar -->
                <div class="floating-toolbar" id="floating-shape-toolbar" style="display: none;">
                    <div class="floating-toolbar-content">
                        <button class="floating-btn shape-btn" id="shape-btn-square" data-shape="square" title="Square">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <rect x="2" y="2" width="12" height="12" rx="1"/>
                            </svg>
                        </button>
                        <button class="floating-btn shape-btn" id="shape-btn-circle" data-shape="circle" title="Circle">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <circle cx="8" cy="8" r="6"/>
                            </svg>
                        </button>
                        <div class="floating-separator"></div>
                        <input type="color" id="floating-shape-fill" value="#3b82f6" class="floating-color" title="Fill Color">
                        <div class="floating-separator"></div>
                        <button class="floating-btn" id="floating-shape-stroke-toggle" title="Toggle Stroke"><strong>S</strong></button>
                        <input type="color" id="floating-shape-stroke-color" value="#000000" class="floating-color" title="Stroke Color">
                        <input type="number" id="floating-shape-stroke-width" min="0" max="20" value="2" class="floating-input-sm" title="Stroke Width">
                        <div class="floating-separator" id="corner-radius-separator" style="display: none;"></div>
                        <button class="floating-btn" id="floating-shape-radius-toggle" title="Toggle Corner Radius" style="display: none;">
                            <strong>R</strong>
                        </button>
                        <input type="number" id="floating-shape-corner-radius" min="0" max="100" value="0" class="floating-input-sm" title="Corner Radius" style="display: none;">
                    </div>
                </div>

                <div class="canvas-container" id="canvas-container">
                    <canvas id="main-canvas"></canvas>
                </div>

                <!-- Assets Library View -->
                <div class="assets-library-view" id="assets-library-view" style="display: none;">
                    <div class="assets-library-header">
                        <div class="assets-library-header-left">
                            <h1>Assets Library</h1>
                        </div>
                        <div class="assets-library-controls">
                            <input type="text" class="assets-search-bar" id="assets-search-bar" placeholder="Search assets...">
                            <button class="assets-import-btn" id="assets-library-import-btn">+ Import Images</button>
                            <div class="assets-view-buttons">
                                <button class="assets-view-btn active" id="board-assets-btn">Board Assets</button>
                                <button class="assets-view-btn" id="all-assets-btn">All Assets</button>
                            </div>
                        </div>
                    </div>
                    <div class="assets-tag-filter-bar" id="assets-tag-filter-bar" style="display: none;">
                        <span class="assets-tag-filter-label">Filter by tags:</span>
                        <div class="assets-tag-filter-pills" id="assets-tag-filter-pills"></div>
                        <button class="assets-tag-clear-btn" id="assets-tag-clear-btn">Clear All</button>
                    </div>
                    <div class="assets-library-content">
                        <div class="assets-library-grid" id="assets-library-grid">
                            <div class="empty-message">No assets yet. Click "+ Import Images" to get started.</div>
                        </div>
                    </div>
                </div>

                <div class="canvas-context-menu" id="canvas-context-menu">
                    <div class="context-menu-item" id="context-delete-selected" style="display: none;">Delete Selected</div>
                    <div class="context-menu-item" id="context-deselect-all" style="display: none;">Deselect All</div>
                    <div class="context-menu-item" id="context-crop-image" style="display: none;">Crop Image</div>
                    <div class="context-menu-item" id="context-uncrop-image" style="display: none;">Uncrop Image</div>
                    <div class="context-menu-item" id="context-edit-image" style="display: none;">Edit Image</div>
                    <div class="context-menu-item" id="context-extract-colors" style="display: none;">Extract Colors</div>
                    <div class="context-menu-separator" id="context-separator" style="display: none;"></div>
                    <div class="context-menu-item" id="context-recenter">Recenter View</div>
                    <div class="context-menu-separator"></div>
                    <div class="context-menu-item" id="context-shortcuts">Keyboard Shortcuts</div>
                </div>
            </main>

            <!-- Right Tools Sidebar -->
            <aside class="tools-sidebar" id="tools-sidebar">
                <div class="tools-sidebar-content">
                    <button class="tool-btn" id="drawing-mode-btn" title="Drawing Mode">
                        <img src="/assets/PenIcon.svg" alt="Drawing Mode" class="tool-icon theme-icon">
                    </button>
                    <button class="tool-btn" id="shape-tool-btn" title="Shape Tool">
                        <img src="/assets/ShapeIcon.svg" alt="Shape Tool" class="tool-icon theme-icon">
                    </button>
                    <button class="tool-btn" id="text-tool-btn" title="Text Tool">
                        <img src="/assets/TextIcon.svg" alt="Text Tool" class="tool-icon theme-icon">
                    </button>
                    <button class="tool-btn" id="color-extractor-btn" title="Color Extractor">
                        <img src="/assets/ColorPalette.svg" alt="Color Extractor" class="tool-icon theme-icon">
                    </button>
                </div>
            </aside>

            <div class="draw-opacity-slider-container" id="draw-opacity-slider-container">
                <input type="range" id="draw-opacity-slider" class="draw-opacity-slider-vertical" min="0" max="100" value="100">
                <div class="draw-opacity-label">%</div>
            </div>
        </div>

        <!-- Layer context menu -->
        <div class="layer-context-menu" id="layer-context-menu">
            <div class="layer-context-menu-item" id="layer-context-rename">Rename</div>
            <div class="layer-context-menu-separator"></div>
            <div class="layer-context-menu-item" id="layer-context-ungroup" style="display: none;">Remove from Group</div>
            <div class="layer-context-menu-item" id="layer-context-duplicate">Duplicate</div>
            <div class="layer-context-menu-item" id="layer-context-delete">Delete</div>
        </div>

        <!-- Asset Details Sidebar -->
        <aside class="asset-sidebar" id="asset-sidebar">
            <div class="asset-sidebar-header">
                <h2>Asset Details</h2>
                <button class="asset-sidebar-close" id="asset-sidebar-close">×</button>
            </div>
            <div class="asset-sidebar-body">
                <img src="" alt="Asset Preview" class="asset-sidebar-preview" id="asset-sidebar-preview">
                <div class="asset-sidebar-section">
                    <h3>Name</h3>
                    <input type="text" class="asset-sidebar-input" id="asset-sidebar-name" placeholder="Asset name">
                </div>
                <div class="asset-sidebar-section">
                    <h3>Tags</h3>
                    <div class="asset-sidebar-tags" id="asset-sidebar-tags"></div>
                    <div class="asset-tag-quick-presets" id="asset-tag-quick-presets"></div>
                    <div class="asset-tag-input-row">
                        <input type="text" class="asset-sidebar-input asset-tag-input" id="asset-tag-input" placeholder="Add a tag">
                        <button class="asset-tag-add-btn" id="asset-tag-add-btn">Add</button>
                    </div>
                    <div class="asset-tag-presets-dropdown" id="asset-tag-presets-dropdown"></div>
                </div>
                <div class="asset-sidebar-section">
                    <h3>Metadata</h3>
                    <div class="asset-sidebar-metadata" id="asset-sidebar-metadata"></div>
                </div>
                <div class="asset-sidebar-section">
                    <div class="asset-sidebar-actions">
                        <button class="asset-sidebar-btn asset-sidebar-btn-primary" id="asset-sidebar-add-to-canvas">Add to Canvas</button>
                        <button class="asset-sidebar-btn asset-sidebar-btn-danger" id="asset-sidebar-delete">Delete Asset</button>
                    </div>
                </div>
            </div>
        </aside>
    </div>

    <!-- Keyboard Shortcuts Modal -->
    <div class="modal-overlay" id="shortcuts-modal-overlay">
        <div class="modal shortcuts-modal">
            <div class="modal-header">
                <h2>Keyboard Shortcuts</h2>
                <button class="modal-close-btn" id="shortcuts-modal-close">×</button>
            </div>
            <div class="modal-body shortcuts-modal-body">
                <div class="shortcuts-section">
                    <h3>General</h3>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Ctrl</kbd> + <kbd>Z</kbd></span>
                        <span class="shortcut-desc">Undo</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Ctrl</kbd> + <kbd>Y</kbd></span>
                        <span class="shortcut-desc">Redo</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Z</kbd></span>
                        <span class="shortcut-desc">Redo (Alternative)</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Delete</kbd> / <kbd>Backspace</kbd></span>
                        <span class="shortcut-desc">Delete selected layer(s)</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Escape</kbd></span>
                        <span class="shortcut-desc">Cancel crop mode / Close modals</span>
                    </div>
                </div>

                <div class="shortcuts-section">
                    <h3>Canvas Navigation</h3>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Mouse Wheel</kbd></span>
                        <span class="shortcut-desc">Zoom in/out</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Middle Mouse</kbd> + Drag</span>
                        <span class="shortcut-desc">Pan canvas</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Space</kbd> + Drag</span>
                        <span class="shortcut-desc">Pan canvas</span>
                    </div>
                </div>

                <div class="shortcuts-section">
                    <h3>Layer Manipulation</h3>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Alt</kbd> + Hold Mouse</span>
                        <span class="shortcut-desc">Rotate selected layer</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Ctrl</kbd> + Click</span>
                        <span class="shortcut-desc">Multi-select layers</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Shift</kbd> + Click</span>
                        <span class="shortcut-desc">Select range of layers</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>R</kbd></span>
                        <span class="shortcut-desc">Reset Rotation</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys"><kbd>Ctrl</kbd> + <kbd>G</kbd></span>
                        <span class="shortcut-desc">Create Group (Must have atleast 2 layers selected)</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-keys">Right Click Layer</span>
                        <span class="shortcut-desc">Layer context menu</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="js/vendor/gifuct-js.js"></script>
    <script type="module">
        import { initApp } from './js/app.js';
        import './js/titlebar.js';

        // Initialize app when DOM is ready
        document.addEventListener('DOMContentLoaded', async () => {
            await initApp();
        });
    </script>
</body>
</html>
